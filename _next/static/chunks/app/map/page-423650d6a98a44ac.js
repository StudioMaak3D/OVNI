(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[823],{82:(e,t,s)=>{"use strict";function a(e){let t=new Map;for(let s of e){let e=function(e){let t=e.trim().toUpperCase();return"2A"===t||"2B"===t||3===t.length&&/^\d{3}$/.test(t)?t:/^\d+$/.test(t)?t.padStart(2,"0"):t}(s.departement);if(!e)continue;t.has(e)||t.set(e,{code:e,name:s.region||"Unknown",totalCases:0,byClassification:{},cases:[]});let a=t.get(e);a.totalCases++;let i=s.classification||"NC";a.byClassification[i]=(a.byClassification[i]||0)+1,a.cases.push(s)}return t}function i(e,t){let s=e;if(t.classifications&&t.classifications.length>0&&(s=s.filter(e=>t.classifications.includes(e.classification))),t.yearRange){let[e,a]=t.yearRange;s=s.filter(t=>{let s;if(t.date.includes("/"))s=parseInt(t.date.split("/")[2]);else{if(!t.date.includes("-"))return!0;s=parseInt(t.date.split("-")[0])}return s>=e&&s<=a})}return s}function n(e){let t=0;for(let s of e.values())s.totalCases>t&&(t=s.totalCases);return t||1}s.d(t,{AY:()=>a,Ge:()=>i,My:()=>n})},1904:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>C});var a=s(5223),i=s(7135),n=s(7156),l=s(8004),c=s(8001),r=s(82);function d(e){let{children:t,loading:s,error:i}=e;return s?(0,a.jsx)("div",{className:"map-container flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"terminal-spinner mx-auto mb-4"}),(0,a.jsxs)("div",{className:"terminal-text text-tech-white",children:["LOADING MAP DATA",(0,a.jsx)("span",{className:"blinking-cursor"})]}),(0,a.jsx)("div",{className:"text-tech-dim text-xs mt-2",children:"Initializing visualization systems..."})]})}):i?(0,a.jsx)("div",{className:"map-container flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center border border-red-500 p-8 max-w-md",children:[(0,a.jsx)("div",{className:"terminal-text text-red-500 text-lg mb-4",children:"[ERROR]"}),(0,a.jsx)("div",{className:"text-tech-white text-sm mb-4",children:i}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"terminal-button",children:"[RELOAD]"})]})}):(0,a.jsx)("div",{className:"map-container relative",children:t})}s(7675);var o=s(4183),x=s(5908);let m="".concat(c.o,"/geojson/france-departments.geojson");function h(e){let{departmentData:t,onDepartmentClick:s,onDepartmentHover:n,hoveredDepartment:l,selectedDepartment:c,leftPanelVisible:r=!0,isLargeScreen:d=!1}=e,h=(0,i.useMemo)(()=>{let e=Math.max(...Array.from(t.values()).map(e=>e.totalCases),1);return(0,x.ae)(e)},[t]),u=(0,i.useMemo)(()=>d||r?[2.5,46.2]:[5,46.2],[r,d]);return(0,a.jsx)(o.ComposableMap,{projection:"geoMercator",projectionConfig:{center:u,scale:1900},className:"w-full h-full",style:{width:"100%",height:"100%"},children:(0,a.jsx)(o.Geographies,{geography:m,children:e=>{let{geographies:i}=e;return i.map(e=>{let i=e.properties.code,r=t.get(i),d=l===i,x=c===i,m="#000000";return r&&(m=h(r.totalCases)),x?m="#FFFFFF":d&&(m="#DDDDDD"),(0,a.jsx)(o.Geography,{geography:e,fill:m,stroke:x||d?"#FFFFFF":"#666666",strokeWidth:x?2:d?1.5:.5,onMouseEnter:()=>null==n?void 0:n(i),onMouseLeave:()=>null==n?void 0:n(null),onClick:()=>null==s?void 0:s(i),style:{default:{outline:"none"},hover:{outline:"none",cursor:"pointer"},pressed:{outline:"none"}}},e.rsmKey)})}})})}function u(){return(0,a.jsxs)("svg",{className:"absolute inset-0 pointer-events-none",width:"100%",height:"100%",children:[Array.from({length:20},(e,t)=>5*t).map(e=>(0,a.jsx)("line",{x1:"".concat(e,"%"),y1:"0",x2:"".concat(e,"%"),y2:"100%",className:"grid-line"},"v-".concat(e))),Array.from({length:20},(e,t)=>5*t).map(e=>(0,a.jsx)("line",{x1:"0",y1:"".concat(e,"%"),x2:"100%",y2:"".concat(e,"%"),className:"grid-line"},"h-".concat(e))),(0,a.jsx)("text",{x:"20",y:"25",className:"terminal-text text-tech-grey",fontSize:"10",opacity:"0.6",children:"LAT: 47\xb0N"}),(0,a.jsx)("text",{x:"20",y:"40",className:"terminal-text text-tech-grey",fontSize:"10",opacity:"0.6",children:"LON: 2.5\xb0E"}),(0,a.jsx)("text",{x:"20",y:"96%",className:"terminal-text text-tech-grey",fontSize:"10",opacity:"0.6",children:"SCALE: 1:1900"})]})}function p(e){let{departmentData:t,maxCases:s}=e,[n,l]=(0,i.useState)(!1),c={};for(let e of t.values())for(let[t,s]of Object.entries(e.byClassification))c[t]=(c[t]||0)+s;return(0,a.jsxs)("div",{className:"map-legend",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("div",{className:"control-panel-header text-xs mb-0",children:"LEGEND"}),(0,a.jsx)("button",{onClick:()=>l(!n),className:"terminal-button text-xs px-2 py-1",children:n?"[-]":"[+]"})]}),(0,a.jsx)("p",{className:"text-tech-dim text-xs mb-4 leading-relaxed",children:"Case density and classification breakdown"}),n&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("div",{className:"text-tech-grey text-xs mb-2",children:"CASE DENSITY"}),(0,a.jsx)("div",{className:"legend-gradient mb-1"}),(0,a.jsxs)("div",{className:"flex justify-between text-tech-dim text-xs",children:[(0,a.jsx)("span",{children:"0"}),(0,a.jsx)("span",{children:s})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-tech-grey text-xs mb-2",children:"CLASSIFICATIONS"}),(0,a.jsx)("div",{className:"space-y-2",children:Object.entries(x.k_).map(e=>{let[t,s]=e,i=c[t]||0;return 0===i&&"A"!==t&&"B"!==t&&"C"!==t&&"D"!==t?null:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)("div",{className:"w-3 h-3 border",style:{backgroundColor:s,borderColor:s}}),(0,a.jsxs)("span",{className:"classification-badge classification-".concat(t," text-xs"),children:["[",t,"]"]}),(0,a.jsx)("span",{className:"text-tech-white case-count",children:i.toString().padStart(4,"0")}),(0,a.jsx)("span",{className:"text-tech-dim text-xs flex-1 truncate",children:(0,x.PE)(t)})]},t)})})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-tech",children:[(0,a.jsx)("div",{className:"text-tech-grey text-xs mb-1",children:"TOTAL OBSERVATIONS"}),(0,a.jsx)("div",{className:"text-tech-white text-lg case-count",children:Array.from(t.values()).reduce((e,t)=>e+t.totalCases,0).toString().padStart(5,"0")}),(0,a.jsxs)("div",{className:"text-tech-dim text-xs mt-1",children:["Across ",t.size," departments"]})]})]})]})}let j=["A","B","C","D","D1"];function f(e){let{filters:t,onFiltersChange:s}=e,[n,l]=(0,i.useState)(!1),c=(e,a)=>{let i=[...t.yearRange];i[e]=a,i[0]>i[1]&&(0===e?i[1]=i[0]:i[0]=i[1]),s({...t,yearRange:i})},r=t.classifications.length>0||1937!==t.yearRange[0]||2024!==t.yearRange[1];return(0,a.jsxs)("div",{className:"control-panel",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("div",{className:"control-panel-header mb-0",children:"FILTERS"}),(0,a.jsx)("button",{onClick:()=>l(!n),className:"terminal-button text-xs px-2 py-1",children:n?"[-]":"[+]"})]}),(0,a.jsx)("p",{className:"text-tech-dim text-xs mb-4 leading-relaxed",children:"Filter observations by classification type and year range"}),n&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-tech-grey text-xs mb-3",children:"CLASSIFICATION"}),(0,a.jsx)("div",{className:"space-y-2",children:j.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer hover:bg-white hover:bg-opacity-5 p-1 transition",children:[(0,a.jsx)("input",{type:"checkbox",className:"terminal-checkbox",checked:t.classifications.includes(e),onChange:()=>(e=>{let a=t.classifications.includes(e)?t.classifications.filter(t=>t!==e):[...t.classifications,e];s({...t,classifications:a})})(e)}),(0,a.jsxs)("span",{className:"classification-badge classification-".concat(e," text-xs"),children:["[",e,"]"]}),(0,a.jsx)("span",{className:"text-tech-dim text-xs",children:(0,x.PE)(e)})]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-tech-grey text-xs mb-3",children:["YEAR RANGE: ",t.yearRange[0]," - ",t.yearRange[1]]}),(0,a.jsxs)("div",{className:"relative h-8",children:[(0,a.jsx)("div",{className:"absolute w-full top-1/2 -translate-y-1/2 h-1 bg-tech-dim rounded",children:(0,a.jsx)("div",{className:"absolute h-1 bg-white rounded",style:{left:"".concat((t.yearRange[0]-1937)/87*100,"%"),right:"".concat(100-(t.yearRange[1]-1937)/87*100,"%")}})}),(0,a.jsx)("input",{type:"range",min:1937,max:2024,value:t.yearRange[1],onChange:e=>c(1,parseInt(e.target.value)),className:"absolute w-full top-1/2 -translate-y-1/2",style:{zIndex:1}}),(0,a.jsx)("input",{type:"range",min:1937,max:2024,value:t.yearRange[0],onChange:e=>c(0,parseInt(e.target.value)),className:"absolute w-full top-1/2 -translate-y-1/2",style:{zIndex:2}})]})]}),r&&(0,a.jsx)("button",{onClick:()=>{s({classifications:[],yearRange:[1937,2024]})},className:"terminal-button w-full text-xs",children:"[RESET FILTERS]"})]}),!n&&r&&(0,a.jsxs)("div",{className:"text-tech-dim text-xs",children:[t.classifications.length>0&&(0,a.jsxs)("div",{children:["Classifications: ",t.classifications.join(", ")]}),(1937!==t.yearRange[0]||2024!==t.yearRange[1])&&(0,a.jsxs)("div",{children:["Years: ",t.yearRange[0]," - ",t.yearRange[1]]})]})]})}function g(e){let{departmentCode:t,departmentData:s,mousePosition:n}=e,[l,c]=(0,i.useState)({x:0,y:0});if((0,i.useEffect)(()=>{let e=n.x+20,t=n.y+20;e+300+20>window.innerWidth&&(e=n.x-300-20),e<20&&(e=20),t+250+20>window.innerHeight&&(t=n.y-250-20),t<20&&(t=20),c({x:e,y:t})},[n]),!t)return null;let r=s.get(t);if(!r)return null;let d=(0,x.Wz)(t);return(0,a.jsxs)("div",{className:"map-tooltip",style:{left:"".concat(l.x,"px"),top:"".concat(l.y,"px")},children:[(0,a.jsxs)("div",{className:"text-tech-white font-bold mb-2",children:["> D\xc9PARTEMENT_",t.padEnd(3,"_")]}),(0,a.jsx)("div",{className:"text-tech-grey text-xs mb-3",children:d}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"text-tech-white",children:[(0,a.jsx)("span",{className:"text-tech-grey",children:"OBSERVATIONS:"})," ",(0,a.jsx)("span",{className:"case-count",children:r.totalCases.toString().padStart(4,"0")})]}),Object.keys(r.byClassification).length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-tech-grey text-xs mt-2 mb-1",children:"CLASSIFICATION_BREAKDOWN:"}),(0,a.jsx)("div",{className:"ml-4 space-y-0.5 text-xs",children:Object.entries(r.byClassification).sort((e,t)=>{let[s]=e,[a]=t;return s.localeCompare(a)}).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"classification-badge classification-".concat(t),children:["[",t,"]"]}),(0,a.jsx)("span",{className:"text-tech-white case-count",children:s.toString().padStart(3,"0")}),(0,a.jsx)("span",{className:"text-tech-dim text-xs",children:(0,x.PE)(t)})]},t)})})]})]}),(0,a.jsx)("div",{className:"text-xs text-tech-grey mt-3 animate-pulse",children:"> CLICK_FOR_DETAILS_"})]})}var N=s(7661);function v(e){let{departmentCode:t,departmentData:s,onClose:n}=e,[l,c]=(0,i.useState)(null);if(!t)return null;let r=s.get(t);if(!r)return null;let d=(0,x.Wz)(t);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"detail-panel fixed right-0 top-16 w-full md:w-96 z-40 h-[calc(100vh-4rem)]",children:[(0,a.jsxs)("div",{className:"detail-panel-header",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-tech-white font-bold text-lg mb-1",children:["D\xc9PARTEMENT [",t,"]"]}),(0,a.jsx)("div",{className:"text-tech-grey text-sm",children:d})]}),(0,a.jsx)("button",{onClick:n,className:"terminal-button text-xs px-3 py-1","aria-label":"Close panel",children:"[X]"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-tech-grey",children:"Total Observations:"}),(0,a.jsx)("span",{className:"text-tech-white case-count",children:r.totalCases.toString().padStart(4,"0")})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-tech-grey",children:"Testimonies:"}),(0,a.jsx)("span",{className:"text-tech-white case-count",children:r.cases.reduce((e,t)=>e+t.temoignages.length,0)})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("div",{className:"text-tech-grey text-xs mb-2",children:"CLASSIFICATIONS"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(r.byClassification).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsxs)("span",{className:"classification-badge classification-".concat(t),children:["[",t,"]"]}),(0,a.jsx)("span",{className:"text-tech-white case-count",children:s})]},t)})})]})]}),(0,a.jsxs)("div",{className:"px-6 pb-6",children:[(0,a.jsxs)("div",{className:"text-tech-grey text-xs mb-3 uppercase",children:["Observations (",r.cases.length,")"]}),(0,a.jsx)("div",{className:"space-y-3",children:r.cases.sort((e,t)=>t.date.localeCompare(e.date)).map(e=>(0,a.jsxs)("button",{onClick:()=>c(e),className:"w-full text-left border border-tech p-3 hover:border-tech-bright hover:bg-white hover:bg-opacity-5 transition",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,a.jsx)("div",{className:"text-tech-white text-sm font-bold truncate flex-1",children:e.titre}),(0,a.jsxs)("span",{className:"classification-badge classification-".concat(e.classification," flex-shrink-0"),children:["[",e.classification,"]"]})]}),(0,a.jsx)("div",{className:"text-tech-dim text-xs mb-1",children:e.date}),e.resumeCourt&&(0,a.jsx)("div",{className:"text-tech-grey text-xs line-clamp-2",children:e.resumeCourt}),(0,a.jsxs)("div",{className:"text-tech-dim text-xs mt-2",children:[e.temoignages.length," t\xe9moignage",e.temoignages.length>1?"s":""]})]},e.id))})]})]}),l&&(0,a.jsx)(N.A,{cas:l,onClose:()=>c(null)})]})}var b=s(6335);function y(){let e=(0,n.useSearchParams)(),[t,s]=(0,i.useState)([]),[o,x]=(0,i.useState)(!0),[m,j]=(0,i.useState)(null),[y,C]=(0,i.useState)(null),[w,S]=(0,i.useState)(null),[E,A]=(0,i.useState)(null),[R,I]=(0,i.useState)({x:0,y:0}),[k,F]=(0,i.useState)({classifications:[],yearRange:[1937,2024]}),[O,D]=(0,i.useState)(!0),[L,T]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{try{x(!0),j(null);let e=await fetch("".concat(c.o,"/data/geipan_case_ovni_production.csv"));if(!e.ok)throw Error("Failed to load data: ".concat(e.statusText));let t=await e.text(),a=(0,l.L1)(t);s(a)}catch(e){console.error("Error loading data:",e),j(e instanceof Error?e.message:"Failed to load data")}finally{x(!1)}})()},[]),(0,i.useEffect)(()=>{let s=e.get("case");if(s&&t.length>0){let e=t.find(e=>e.id===s);e&&A(e)}},[e,t]),(0,i.useEffect)(()=>{let e=()=>{T(window.innerWidth>1680)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{let e=e=>{I({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)},[]);let z=(0,i.useMemo)(()=>{let e=(0,r.Ge)(t,k);return(0,r.AY)(e)},[t,k]),M=(0,i.useMemo)(()=>(0,r.My)(z),[z]);return(0,a.jsxs)("main",{className:"technical-map min-h-screen",children:[(0,a.jsx)(b.A,{title:"OVNI EXPLORER // MAP"}),(0,a.jsxs)("div",{className:"pt-16 h-screen flex",children:[O&&(0,a.jsxs)("aside",{className:"w-80 border-r border-tech overflow-y-auto bg-tech-dark",children:[(0,a.jsx)(f,{filters:k,onFiltersChange:F}),(0,a.jsx)("div",{className:"border-t border-tech mt-6",children:(0,a.jsx)(p,{departmentData:z,maxCases:M})}),(0,a.jsxs)("div",{className:"border-t border-tech mt-6 p-6",children:[(0,a.jsx)("div",{className:"text-tech-grey text-xs font-bold mb-3 uppercase tracking-wider",children:"About this visualization"}),(0,a.jsxs)("p",{className:"text-tech-dim text-xs leading-relaxed mb-3",children:["This map displays ",Array.from(z.values()).reduce((e,t)=>e+t.totalCases,0).toLocaleString()," OVNI observations reported in France and collected by GEIPAN (Groupe d'\xc9tudes et d'Informations sur les Ph\xe9nom\xe8nes A\xe9rospatiaux Non-identifi\xe9s)."]}),(0,a.jsx)("p",{className:"text-tech-dim text-xs leading-relaxed",children:"Each department is shaded according to the number of reported cases. Hover over a department to see details, or click to explore individual observations."})]})]}),(0,a.jsxs)("div",{className:"flex-1 relative",children:[!O&&(0,a.jsx)("button",{onClick:()=>D(!0),className:"terminal-button absolute top-4 left-4 z-50 text-xs px-3 py-2","aria-label":"Show filters panel",children:"[SHOW FILTERS]"}),(0,a.jsx)(d,{loading:o,error:m,children:!o&&!m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute inset-0",style:{zIndex:0},children:(0,a.jsx)(u,{})}),(0,a.jsx)("div",{className:"absolute inset-0",style:{zIndex:1},children:(0,a.jsx)(h,{departmentData:z,onDepartmentClick:e=>{S(e),C(null),L||D(!1)},onDepartmentHover:e=>{w||C(e)},hoveredDepartment:y,selectedDepartment:w,leftPanelVisible:O,isLargeScreen:L})}),(0,a.jsx)(g,{departmentCode:y,departmentData:z,mousePosition:R})]})})]}),w&&(0,a.jsx)(v,{departmentCode:w,departmentData:z,onClose:()=>{S(null),D(!0)}})]}),E&&(0,a.jsx)(N.A,{cas:E,onClose:()=>A(null)})]})}function C(){return(0,a.jsx)(i.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-tech-dark flex items-center justify-center text-tech-white",children:"Loading..."}),children:(0,a.jsx)(y,{})})}},8935:(e,t,s)=>{Promise.resolve().then(s.bind(s,1904))}},e=>{e.O(0,[354,380,183,817,661,531,813,358],()=>e(e.s=8935)),_N_E=e.O()}]);